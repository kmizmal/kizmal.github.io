<!DOCTYPE html><html lang=zh-CN><head><meta charset=utf-8><title>热点下快速adb连接bat | zmalの折腾笔记</title><meta name=author content=zmal><meta name=description content=一个平平无奇的小站><meta name=keywords content=""><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><link rel=icon href=/images/avatar.png><link rel=preconnect href=https://s4.zstatic.net><script src=https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js></script><link rel=stylesheet href=https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css><link rel=preconnect href=https://fonts.googleapis.cn><link rel=preconnect href=https://fonts.gstatic.cn crossorigin><link rel=stylesheet href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"><script>let mixins={}</script><script src=https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/lib/highlight.min.js></script><script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script><script src=https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js></script><script src=https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js></script><link rel=stylesheet href=https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css><script src=/js/lib/highlight.js></script><script src=/js/lib/preview.js></script><link rel=stylesheet href=/css/main.css><script src=/js/jquery-3.7.1.js></script><style>body{cursor:url(/images/Arrow.ico),auto}</style><script>((e,t)=>{var i=t.createElement("div"),n=(i.style.cssText="position: fixed; top: 0; left: 0; width: 0; height: 3px;box-shadow: 0 0 3px #999; background: -webkit-linear-gradient(left, red,orange,yellow,green,blue,indigo,violet );z-index: 999999;-webkit-transition:width .3s linear;",t.body.appendChild(i),e.innerHeight||t.documentElement.clientHeight||t.body.clientHeight);e.addEventListener("scroll",function(){i.style.width=Math.round(pageYOffset/(t.body.offsetHeight-n)*100)+"%"},!1)})(window,document)</script><meta name=generator content="Hexo 7.3.0"></head><body><div id=layout><transition name=fade><div id=loading v-show=loading><div id=loading-circle><h2>LOADING</h2><p>加载过慢请开启缓存 浏览器默认开启</p><img src=/images/loading.gif></div></div></transition><div id=menu :class="{ hidden: hiddenMenu, 'menu-color': menuColor}"><nav id=desktop-menu><a class=title href=/ ><span>ZMALの折腾笔记</span> </a><a href=/ ><i class="fa-solid fa-house fa-fw"></i> <span>&ensp;Home</span> </a><a href=/about><i class="fa-solid fa-id-card fa-fw"></i> <span>&ensp;About</span> </a><a href=/archives><i class="fa-solid fa-box-archive fa-fw"></i> <span>&ensp;Archives</span></a></nav><nav id=mobile-menu><div class=title @click="showMenuItems = !showMenuItems"><i class="fa-solid fa-bars fa-fw"></i> <span>&emsp;ZMALの折腾笔记</span></div><transition name=slide><div class=items v-show=showMenuItems><a href=/ ><div class=item><div style=min-width:20px;max-width:50px;width:10%><i class="fa-solid fa-house fa-fw"></i></div><div style=min-width:100px;max-width:150%;width:20%>Home</div></div></a><a href=/about><div class=item><div style=min-width:20px;max-width:50px;width:10%><i class="fa-solid fa-id-card fa-fw"></i></div><div style=min-width:100px;max-width:150%;width:20%>About</div></div></a><a href=/archives><div class=item><div style=min-width:20px;max-width:50px;width:10%><i class="fa-solid fa-box-archive fa-fw"></i></div><div style=min-width:100px;max-width:150%;width:20%>Archives</div></div></a></div></transition></nav></div><transition name=fade><div id=menu-curtain @click="showMenuItems = !showMenuItems" v-show=showMenuItems></div></transition><div id=main :class="loading ? 'into-enter-from': 'into-enter-active'"><div class=article><div><h1>热点下快速adb连接bat</h1></div><div class=info><span class=date><span class=icon><i class="fa-solid fa-calendar fa-fw"></i> </span>2025/1/8</span></div><div class=content v-pre><p>我觉得<a target=_blank rel=noopener href=https://github.com/Genymobile/scrcpy>scrcpy</a>挺好用的，但是我刷了<a target=_blank rel=noopener href=https://github.com/Genymobile/scrcpy>box4</a>走系统级代理导致usb网络共享总是出现奇奇怪怪的bug</p><p>但是不知道为什么一加开热点每次网关ip都会变，</p><p>索性在gpt的帮助下写了这个脚本，<del>开始是想用<code>find</code>匹配的，但是我处理不好ipv6那个地址处理捣乱，，所以脚本里面是硬编码了网关那一行</del><br>用了几天好像没什么问题就发出来当备份了</p><p><code>scrcpy</code>后面带的参数是为了处理键盘输入和音频传递</p><pre><code class=language-bat>@echo off
chcp 65001

setlocal enabledelayedexpansion
set ipAddress=

:: 获取第 24 行 IP 地址
for /f &quot;skip=23 tokens=*&quot; %%A in (&#39;ipconfig&#39;) do (
    set ipAddress=%%A
    goto :found
)

:: 替换为你实际打开的端口
echo 第 24 行：!ipAddress!
adb connect !ipAddress!:6666
:: 自行替换scrcpy路径
&quot;E:\study\bash\adb\scrcpy-win64-v3.1\scrcpy.exe&quot; --pause-on-exit=if-error --audio-source=playback --audio-dup --keyboard=uhid

pause
</code></pre></div></div><footer id=footer><div id=footer-wrap><div>&copy; 2022 - 2025 zmalの折腾笔记 <span id=footer-icon><i class="fa-solid fa-font-awesome fa-fw"></i> </span>&commat;zmal</div><div>Based on the <a target=_blank rel=noopener href=https://hexo.io>Hexo Engine</a> &amp; <a target=_blank rel=noopener href=https://github.com/kmizmal/hexo-theme-particlex>ParticleX Theme</a></div><div>备案号： <a target=_blank rel=noopener href="https://icp.gov.moe/?keyword=20250124">萌ICP备20250124号</a></div></div><script src=/js/zmal.js></script></footer></div><transition name=fade><div id=preview ref=preview v-show=previewShow><img id=preview-content ref=previewContent></div></transition></div><script src=/js/main.js></script></body></html>